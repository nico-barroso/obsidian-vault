var H=Object.create;var u=Object.defineProperty;var W=Object.getOwnPropertyDescriptor;var j=Object.getOwnPropertyNames;var K=Object.getPrototypeOf,z=Object.prototype.hasOwnProperty;var U=(s,e,t)=>e in s?u(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var Y=(s,e)=>()=>(e||s((e={exports:{}}).exports,e),e.exports),q=(s,e)=>{for(var t in e)u(s,t,{get:e[t],enumerable:!0})},G=(s,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of j(e))!z.call(s,n)&&n!==t&&u(s,n,{get:()=>e[n],enumerable:!(i=W(e,n))||i.enumerable});return s};var J=(s,e,t)=>(t=s!=null?H(K(s)):{},G(e||!s||!s.__esModule?u(t,"default",{value:s,enumerable:!0}):t,s)),Q=s=>G(u({},"__esModule",{value:!0}),s);var a=(s,e,t)=>U(s,typeof e!="symbol"?e+"":e,t);var B=Y((ve,A)=>{function V(s){return Array.isArray(s)?s:[s]}var Z=void 0,T="",k=" ",L="\\",ee=/^\s+$/,te=/(?:[^\\]|^)\\$/,se=/^\\!/,ie=/^\\#/,ne=/\r?\n/g,re=/^\.{0,2}\/|^\.{1,2}$/,oe=/\/$/,d="/",I="node-ignore";typeof Symbol!="undefined"&&(I=Symbol.for("node-ignore"));var D=I,p=(s,e,t)=>(Object.defineProperty(s,e,{value:t}),t),ae=/([0-z])-([0-z])/g,O=()=>!1,ce=s=>s.replace(ae,(e,t,i)=>t.charCodeAt(0)<=i.charCodeAt(0)?e:T),he=s=>{let{length:e}=s;return s.slice(0,e-e%2)},le=[[/^\uFEFF/,()=>T],[/((?:\\\\)*?)(\\?\s+)$/,(s,e,t)=>e+(t.indexOf("\\")===0?k:T)],[/(\\+?)\s/g,(s,e)=>{let{length:t}=e;return e.slice(0,t-t%2)+k}],[/[\\$.|*+(){^]/g,s=>`\\${s}`],[/(?!\\)\?/g,()=>"[^/]"],[/^\//,()=>"^"],[/\//g,()=>"\\/"],[/^\^*\\\*\\\*\\\//,()=>"^(?:.*\\/)?"],[/^(?=[^^])/,function(){return/\/(?!$)/.test(this)?"^":"(?:^|\\/)"}],[/\\\/\\\*\\\*(?=\\\/|$)/g,(s,e,t)=>e+6<t.length?"(?:\\/[^\\/]+)*":"\\/.+"],[/(^|[^\\]+)(\\\*)+(?=.+)/g,(s,e,t)=>{let i=t.replace(/\\\*/g,"[^\\/]*");return e+i}],[/\\\\\\(?=[$.|*+(){^])/g,()=>L],[/\\\\/g,()=>L],[/(\\)?\[([^\]/]*?)(\\*)($|\])/g,(s,e,t,i,n)=>e===L?`\\[${t}${he(i)}${n}`:n==="]"&&i.length%2===0?`[${ce(t)}${i}]`:"[]"],[/(?:[^*])$/,s=>/\/$/.test(s)?`${s}$`:`${s}(?=$|\\/$)`]],de=/(^|\\\/)?\\\*$/,E="regex",m="checkRegex",$="_",pe={[E](s,e){return`${e?`${e}[^/]+`:"[^/]*"}(?=$|\\/$)`},[m](s,e){return`${e?`${e}[^/]*`:"[^/]*"}(?=$|\\/$)`}},ge=s=>le.reduce((e,[t,i])=>e.replace(t,i.bind(s)),s),w=s=>typeof s=="string",fe=s=>s&&w(s)&&!ee.test(s)&&!te.test(s)&&s.indexOf("#")!==0,ue=s=>s.split(ne).filter(Boolean),S=class{constructor(e,t,i,n,r,o){this.pattern=e,this.mark=t,this.negative=r,p(this,"body",i),p(this,"ignoreCase",n),p(this,"regexPrefix",o)}get regex(){let e=$+E;return this[e]?this[e]:this._make(E,e)}get checkRegex(){let e=$+m;return this[e]?this[e]:this._make(m,e)}_make(e,t){let i=this.regexPrefix.replace(de,pe[e]),n=this.ignoreCase?new RegExp(i,"i"):new RegExp(i);return p(this,t,n)}},Ee=({pattern:s,mark:e},t)=>{let i=!1,n=s;n.indexOf("!")===0&&(i=!0,n=n.substr(1)),n=n.replace(se,"!").replace(ie,"#");let r=ge(n);return new S(s,e,n,t,i,r)},N=class{constructor(e){this._ignoreCase=e,this._rules=[]}_add(e){if(e&&e[D]){this._rules=this._rules.concat(e._rules._rules),this._added=!0;return}if(w(e)&&(e={pattern:e}),fe(e.pattern)){let t=Ee(e,this._ignoreCase);this._added=!0,this._rules.push(t)}}add(e){return this._added=!1,V(w(e)?ue(e):e).forEach(this._add,this),this._added}test(e,t,i){let n=!1,r=!1,o;this._rules.forEach(g=>{let{negative:f}=g;r===f&&n!==r||f&&!n&&!r&&!t||!g[i].test(e)||(n=!f,r=f,o=f?Z:g)});let C={ignored:n,unignored:r};return o&&(C.rule=o),C}},_e=(s,e)=>{throw new e(s)},c=(s,e,t)=>w(s)?s?c.isNotRelative(s)?t(`path should be a \`path.relative()\`d string, but got "${e}"`,RangeError):!0:t("path must not be empty",TypeError):t(`path must be a string, but got \`${e}\``,TypeError),X=s=>re.test(s);c.isNotRelative=X;c.convert=s=>s;var P=class{constructor({ignorecase:e=!0,ignoreCase:t=e,allowRelativePaths:i=!1}={}){p(this,D,!0),this._rules=new N(t),this._strictPathCheck=!i,this._initCache()}_initCache(){this._ignoreCache=Object.create(null),this._testCache=Object.create(null)}add(e){return this._rules.add(e)&&this._initCache(),this}addPattern(e){return this.add(e)}_test(e,t,i,n){let r=e&&c.convert(e);return c(r,e,this._strictPathCheck?_e:O),this._t(r,t,i,n)}checkIgnore(e){if(!oe.test(e))return this.test(e);let t=e.split(d).filter(Boolean);if(t.pop(),t.length){let i=this._t(t.join(d)+d,this._testCache,!0,t);if(i.ignored)return i}return this._rules.test(e,!1,m)}_t(e,t,i,n){if(e in t)return t[e];if(n||(n=e.split(d).filter(Boolean)),n.pop(),!n.length)return t[e]=this._rules.test(e,i,E);let r=this._t(n.join(d)+d,t,i,n);return t[e]=r.ignored?r:this._rules.test(e,i,E)}ignores(e){return this._test(e,this._ignoreCache,!1).ignored}createFilter(){return e=>!this.ignores(e)}filter(e){return V(e).filter(this.createFilter())}test(e){return this._test(e,this._testCache,!0)}},b=s=>new P(s),me=s=>c(s&&c.convert(s),s,O),M=()=>{let s=t=>/^\\\\\?\\/.test(t)||/["<>|\u0000-\u001F]+/u.test(t)?t:t.replace(/\\/g,"/");c.convert=s;let e=/^[a-z]:\//i;c.isNotRelative=t=>e.test(t)||X(t)};typeof process!="undefined"&&process.platform==="win32"&&M();A.exports=b;b.default=b;A.exports.isPathValid=me;p(A.exports,Symbol.for("setupWindows"),M)});var we={};q(we,{default:()=>R});module.exports=Q(we);var F=J(B()),_=require("obsidian");var h=require("obsidian");var x={ignore:[],timeToRemoveLeaf:100},y=class extends h.PluginSettingTab{constructor(t,i){super(t,i);a(this,"plugin");this.plugin=i}display(){let{containerEl:t}=this;t.empty(),new h.Setting(t).setName("Ignored path pattern").setDesc("Manage notes which do not display the graph banner. This pattern follows .gitignore spec.").addTextArea(i=>i.setPlaceholder(`ignored-path.md
/ignored-dir
!/ignored-dir/not-ignored-path.md`).setValue(this.plugin.settings.ignore.join(`
`)).onChange(async n=>{this.plugin.settings.ignore=n.split(`
`),await this.plugin.saveData(this.plugin.settings)})),new h.Setting(t).setName("Advanced: Time [ms] to remove the graph leaf for the banner").setDesc(`This plugin temporarily create a local graph leaf to display in the banner of the notes.
If you want to do something when the local graph opened, for example by using the "Sync Graph Settings" plugin, set this time settings.
If set to 0ms, the leaf is immediately erased.
To reflect this setting, please reload the app.`).addText(i=>i.setPlaceholder("100").setValue(String(this.plugin.settings.timeToRemoveLeaf)).onChange(async n=>{let r=Number(n);(n===""||Number.isNaN(r)||r<0)&&new h.Notice("Please specify a valid number."),this.plugin.settings.timeToRemoveLeaf=r,await this.plugin.saveData(this.plugin.settings)}))}};var l=class l{constructor(e,t){a(this,"leaf");a(this,"node");a(this,"setupLeafPromise");this.leaf=e.workspace.getLeaf("tab"),this.setupLeafPromise=this.setupLeaf(t.settings.timeToRemoveLeaf);let i=this.leaf.view.containerEl.find(".view-content");this.node=i,this.setupNode()}async setupLeaf(e){await this.leaf.setViewState({type:"localgraph"});let t=()=>this.leaf.parent.removeChild(this.leaf);e>0?setTimeout(t,e):t()}setupNode(){var t;this.node.addClass(l.nodeClass),(t=this.node.find(".graph-controls"))==null||t.toggleClass("is-close",!0);let e=document.createElement("div");e.addClass(l.overlayNodeClass),this.node.insertBefore(e,this.node.querySelector("canvas")),e.addEventListener("pointerup",()=>{if(this.isActive())return;this.setActive(!0);let i=new AbortController;document.addEventListener("pointerdown",n=>{this.isActive()&&(n.target&&this.node.contains(n.target)||(this.setActive(!1),i.abort()))},{signal:i.signal})})}isActive(){return this.node.dataset.interactive==="true"}setActive(e){this.node.dataset.interactive=e.toString()}async placeTo(e){await this.setupLeafPromise,await this.leaf.setViewState({type:"localgraph",state:{file:e.file.path}}),this.leaf.setGroup(e.file.path);let t=e.getMode(),i=e.containerEl.find(`.markdown-${t}-view`);if(this.isDescendantOf(i))return;let n=i.find(".inline-title"),r=n.parentElement;if(!r)throw"Failed to get note header";r.insertAfter(this.node,n)}isDescendantOf(e){return e.contains(this.node)}setVisibility(e){this.node.toggleClass("hidden",!e)}detach(){this.leaf.detach(),this.node.removeClass(l.nodeClass)}};a(l,"nodeClass","graph-banner-content"),a(l,"overlayNodeClass","graph-banner-overlay");var v=l;var R=class extends _.Plugin{constructor(){super(...arguments);a(this,"settings",x);a(this,"graphViews",[])}async onload(){await this.loadSettings(),this.addSettingTab(new y(this.app,this)),this.app.workspace.trigger("parse-style-settings"),this.registerEvent(this.app.workspace.on("file-open",async i=>{if(!i||i.extension!=="md")return;let n=this.app.workspace.getActiveViewOfType(_.MarkdownView);!n||n.file!==i||await this.placeGraphView(n)})),this.registerEvent(this.app.workspace.on("layout-change",async()=>{let i=this.app.workspace.getActiveViewOfType(_.MarkdownView);i&&await this.placeGraphView(i)}));let t=this.app.workspace.getLeavesOfType("markdown");for(let i of t)this.placeGraphView(i.view)}onunload(){for(let t of this.graphViews)t.detach();this.graphViews=[]}async loadSettings(){this.settings=Object.assign({},x,await this.loadData())}async placeGraphView(t){let i=(0,F.default)().add(this.settings.ignore).ignores(t.file.path),n=this.findAvailableGraphView(t);n.setVisibility(!i),await n.placeTo(t)}findAvailableGraphView(t){let i=this.graphViews.find(o=>o.isDescendantOf(t.containerEl));if(i!==void 0)return i;let n=this.app.workspace.getLeavesOfType("markdown").map(o=>o.view.containerEl);for(let o of this.graphViews)if(!n.some(g=>o.isDescendantOf(g)))return o;let r=new v(this.app,this);return this.graphViews.push(r),r}};

/* nosourcemap */